package com.example.demo.repository;

import java.util.List;

import org.springframework.stereotype.Repository;

@Repository
public class ProductVariantRepository {

	public List<ProductVariantRow> findActiveVariantsByProductId(long productId) {
	    String sql = """
	        SELECT material, size, color, price
	        FROM product_variants
	        WHERE product_id = ? AND is_active = 1
	        ORDER BY variant_id ASC
	    """;

	    return jdbcTemplate.query(sql, (rs, rowNum) -> {
	        ProductVariantRow r = new ProductVariantRow();
	        r.setMaterial(rs.getString("material"));
	        r.setSize(rs.getString("size"));     // ✅ đổi size_label -> size
	        r.setColor(rs.getString("color"));
	        r.setPrice(rs.getBigDecimal("price"));
	        return r;
	    }, productId);
	}
}
